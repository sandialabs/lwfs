AM_CFLAGS = -Wall

INCLUDES = $(all_includes)
INCLUDES += -I$(LWFS_SRCDIR)/src

METASOURCES = AUTO


bin_PROGRAMS =  trace_ex1

# Without Pablo, there is nothing to do
if HAVE_PABLO
AM_CPPFLAGS = -DTRACING_ENABLED
endif


trace_ex1_SOURCES =  trace_ex1.c
trace_ex1_LDFLAGS = -L/home/raoldfi/software/lwfs/cnos/lib
trace_ex1_LDFLAGS += -L$(LWFS_BUILDDIR)/src/server
trace_ex1_LDFLAGS += -L$(LWFS_BUILDDIR)/src/support
trace_ex1_LDFLAGS += -L$(LWFS_BUILDDIR)/src/client
#trace_ex1_LDFLAGS += -L/opt/gcc/4.1.2/cnos/lib
trace_ex1_LDADD = -llwfs_server

# Without Pablo, there is nothing to do
if HAVE_PABLO

# Get rules for converting and parsing trace files
include $(top_srcdir)/scripts/trace/trace-rules.mk

TESTS = trace_test

trace_test: trace_ex1 Makefile.am
	@echo "#!/bin/sh" > $@
	@echo "trace_ex1 > trace_ex1.out" >> $@  
	@echo "make trace_ex1.gnu-interval >> trace_ex1.out" >> $@
	@echo "make trace_ex1.gnu-count >> trace_ex1.out" >> $@
	@chmod +x $@

#noinst_DATA = tracing-test.gnu-interval tracing-test.gnu-count

# tracing-test.sddf is generated by tracing-test
tracing-test.sddf: trace-test
	trace-test;

# The rule for this conversion is in trace-rules.mk
tracing-test.gnu-interval: tracing-test.sddf

# The rule for this conversion is in trace-rules.mk
tracing-test.gnu-count: tracing-test.sddf

endif


CLEANFILES = core.* *~ *.xml *.dat *.gnu-interval 
CLEANFILES+= *.gnu-count *.sddf .tmp.xml $(TESTS) *.out
